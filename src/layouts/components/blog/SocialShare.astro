---
interface Props {
  title: string;
  description?: string;
  url?: string;
  platforms?: ("twitter" | "facebook" | "linkedin" | "reddit" | "whatsapp" | "email")[];
  locale?: "en" | "es";
}

const {
  title,
  description = "",
  url = Astro.url.href,
  platforms = ["twitter", "facebook", "linkedin", "reddit", "whatsapp", "email"],
  locale = "en",
} = Astro.props;

const shareLabel = locale === "es" ? "Comparte este articulo" : "Share this article";

const encodedUrl = encodeURIComponent(url);
const encodedTitle = encodeURIComponent(title);
const encodedDescription = encodeURIComponent(description);

const shareLinks: Record<string, string> = {
  twitter: `https://twitter.com/intent/tweet?text=${encodedTitle}&url=${encodedUrl}`,
  facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`,
  linkedin: `https://www.linkedin.com/sharing/share-offsite/?url=${encodedUrl}`,
  reddit: `https://reddit.com/submit?url=${encodedUrl}&title=${encodedTitle}`,
  whatsapp: `https://wa.me/?text=${encodedTitle}%20${encodedUrl}`,
  email: `mailto:?subject=${encodedTitle}&body=${encodedDescription}%0A%0A${encodedUrl}`,
};

const platformLabels: Record<string, string> = {
  twitter: "X",
  facebook: "Facebook",
  linkedin: "LinkedIn",
  reddit: "Reddit",
  whatsapp: "WhatsApp",
  email: "Email",
};
---

<div class="social-share my-8 pt-6 border-t border-gray-200 dark:border-gray-700">
  <p class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-3 text-center">{shareLabel}</p>
  <div class="flex flex-wrap justify-center gap-2">
    {platforms.map((platform) => (
      <a
        href={shareLinks[platform]}
        target="_blank"
        rel="noopener noreferrer"
        class="share-btn"
        aria-label={`Share on ${platformLabels[platform]}`}
        title={`Share on ${platformLabels[platform]}`}
      >
        {platform === "twitter" && (
          <svg viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
        )}
        {platform === "facebook" && (
          <svg viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
            <path d="M9.198 21.5h4v-8.01h3.604l.396-3.98h-4V7.5a1 1 0 0 1 1-1h3v-4h-3a5 5 0 0 0-5 5v2.01h-2l-.396 3.98h2.396v8.01Z"/>
          </svg>
        )}
        {platform === "linkedin" && (
          <svg viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
            <path d="M6.94 5a2 2 0 1 1-4-.002 2 2 0 0 1 4 .002zM7 8.48H3V21h4V8.48zm6.32 0H9.34V21h3.94v-6.57c0-3.66 4.77-4 4.77 0V21H22v-7.93c0-6.17-7.06-5.94-8.72-2.91l.04-1.68z"/>
          </svg>
        )}
        {platform === "reddit" && (
          <svg viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5.8 10.05c.02.15.02.3.02.45 0 2.3-2.68 4.17-5.98 4.17S5.86 14.8 5.86 12.5c0-.15 0-.3.02-.45a1.53 1.53 0 0 1-.63-1.25c0-.85.69-1.53 1.53-1.53.4 0 .77.15 1.05.42 1.03-.75 2.45-1.23 4.02-1.28l.68-3.2a.3.3 0 0 1 .36-.24l2.27.48a1.08 1.08 0 1 1-.12.56l-2.02-.43-.6 2.85c1.54.06 2.94.54 3.95 1.28.28-.27.65-.42 1.05-.42.85 0 1.53.69 1.53 1.53 0 .5-.24.95-.63 1.25zM9.1 12.5c0 .55.45 1 1 1s1-.45 1-1-.45-1-1-1-1 .45-1 1zm5.8 0c0-.55-.45-1-1-1s-1 .45-1 1 .45 1 1 1 1-.45 1-1zm-4.75 2.92c.17.17.44.17.6 0 .47-.47 1.15-.7 1.85-.7s1.38.23 1.85.7c.17.17.44.17.6 0 .17-.17.17-.44 0-.6-.63-.63-1.5-.98-2.45-.98s-1.82.35-2.45.98c-.17.17-.17.44 0 .6z"/>
          </svg>
        )}
        {platform === "whatsapp" && (
          <svg viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
            <path d="M17.6 6.32A7.85 7.85 0 0 0 12.05 4c-4.38 0-7.93 3.55-7.93 7.93a7.9 7.9 0 0 0 1.07 3.98L4 20l4.19-1.1a7.9 7.9 0 0 0 3.77.96h.01c4.38 0 7.93-3.55 7.93-7.93 0-2.12-.82-4.1-2.3-5.6Zm-5.55 12.18a6.57 6.57 0 0 1-3.35-.92l-.24-.14-2.5.65.67-2.43-.16-.25a6.59 6.59 0 0 1-1.01-3.49c0-3.64 2.96-6.6 6.6-6.6a6.56 6.56 0 0 1 4.66 1.93 6.56 6.56 0 0 1 1.93 4.66c0 3.65-2.96 6.6-6.6 6.6Zm3.62-4.94c-.2-.1-1.18-.58-1.36-.64-.18-.07-.32-.1-.45.1-.13.2-.5.64-.62.77-.11.13-.23.15-.43.05-.2-.1-.85-.31-1.62-.99-.6-.53-1-1.2-1.12-1.4-.12-.2-.01-.31.09-.41.09-.09.2-.23.3-.35.1-.12.13-.2.2-.34.07-.13.03-.25-.02-.35-.05-.1-.45-1.08-.62-1.48-.16-.39-.33-.33-.45-.34-.12-.01-.25-.01-.38-.01-.13 0-.34.05-.52.25-.18.2-.68.67-.68 1.63 0 .96.7 1.9.8 2.03.1.13 1.4 2.13 3.39 2.99.47.2.84.33 1.13.42.48.15.91.13 1.25.08.38-.06 1.18-.48 1.35-.95.17-.47.17-.87.12-.95-.05-.09-.19-.14-.4-.24Z"/>
          </svg>
        )}
        {platform === "email" && (
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-4 h-4">
            <rect width="20" height="14" x="2" y="5" rx="2"/>
            <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
          </svg>
        )}
      </a>
    ))}
  </div>
</div>

<style>
  .share-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2.25rem;
    height: 2.25rem;
    border-radius: 9999px;
    background-color: rgb(243 244 246);
    color: rgb(55 65 81);
    transition: all 0.2s;
  }

  .share-btn:hover {
    background-color: rgb(229 231 235);
    transform: scale(1.05);
  }

  :global(.dark) .share-btn {
    background-color: rgb(31 41 55);
    color: rgb(209 213 219);
  }

  :global(.dark) .share-btn:hover {
    background-color: rgb(55 65 81);
  }
</style>
