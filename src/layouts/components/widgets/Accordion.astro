---
export interface Props {
  label: string;
  group?: string;
  expanded?: string;
}

const { label, group, expanded = "false" } = Astro.props;
const isExpanded = expanded === "true";
---

<details
  class="accordion-item not-prose my-4 w-full border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden group"
  open={isExpanded}
  name={group}
>
  <summary class="accordion-header flex justify-between items-center w-full p-4 sm:p-5 text-left bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 cursor-pointer list-none select-none">
    <span class="font-semibold text-base sm:text-lg text-gray-900 dark:text-white pr-4">
      {label}
    </span>
    <svg
      class="accordion-icon w-5 h-5 sm:w-6 sm:h-6 text-gray-500 dark:text-gray-400 shrink-0 transition-transform duration-200"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <polyline points="6 9 12 15 18 9"></polyline>
    </svg>
  </summary>
  <div class="accordion-content p-4 sm:p-6 bg-white dark:bg-gray-900 prose dark:prose-invert prose-lg max-w-none">
    <slot />
  </div>
</details>

<style>
  /* Hide default marker */
  .accordion-header::-webkit-details-marker,
  .accordion-header::marker {
    display: none;
  }

  /* Rotate chevron when open */
  details[open] .accordion-icon {
    transform: rotate(180deg);
  }

  /* Smooth content reveal */
  .accordion-content {
    animation: accordion-open 0.2s ease-out;
  }

  @keyframes accordion-open {
    from {
      opacity: 0;
      transform: translateY(-8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Hover effect */
  .accordion-item:hover {
    box-shadow: 0 2px 8px -2px rgba(0, 0, 0, 0.1);
  }

  :global(.dark) .accordion-item:hover {
    box-shadow: 0 2px 8px -2px rgba(0, 0, 0, 0.3);
  }

  /* Content styling */
  .accordion-content :global(p) {
    margin-bottom: 1rem;
  }

  .accordion-content :global(p:last-child) {
    margin-bottom: 0;
  }

  .accordion-content :global(ul),
  .accordion-content :global(ol) {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
  }

  .accordion-content :global(li) {
    margin-bottom: 0.5rem;
  }

  .accordion-content :global(pre) {
    margin: 1rem 0;
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
  }

  .accordion-content :global(code) {
    padding: 0.125rem 0.25rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
  }

  .accordion-content :global(blockquote) {
    margin: 1rem 0;
    padding-left: 1rem;
    border-left: 4px solid #d1d5db;
  }

  :global(.dark) .accordion-content :global(blockquote) {
    border-left-color: #6b7280;
  }

  /* Focus styles for accessibility */
  .accordion-header:focus-visible {
    outline: 2px solid rgb(59 130 246);
    outline-offset: 2px;
  }
</style>
