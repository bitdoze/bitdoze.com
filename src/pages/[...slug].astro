---
import { getCollection, render } from 'astro:content';
import PostLayout from '@layouts/PostLayout.astro';
// Import all widget components for MDX files
import * as MarkdownComponents from '@layouts/components/MarkdownComponents.astro';
import { getEntrySlug } from '@utils/content';

// Get all blog posts
export async function getStaticPaths() {
  const posts = await getCollection('posts', ({ data }) => !data.draft);
  
  return posts.map(post => ({
    params: { slug: getEntrySlug(post) },
    props: { post },
  }));
}

const { post } = Astro.props;
// Pass all widget components to MDX content
const { Content, headings } = await render(post);

// Make all components available to MDX content
const components = MarkdownComponents;
---

<PostLayout post={post} headings={headings}>
  <Content components={components} />
</PostLayout>
